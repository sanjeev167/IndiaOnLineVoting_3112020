/**
 * 
 */
package com.pon.pub.hm.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.pon.pvt.master.repo.VotersEnrolledRepository;
import com.support.custom.exception.CustomRuntimeException;
import com.support.util.AppUtil;

/**
 * @author Sanjeev
 *
 */
@Service
public class VoterIdentificationServiceImpl implements VoterIdentificationService{
	
	@Autowired
	VotersEnrolledRepository votersEnrolledRepository;

	@Override
	public String [] verifyVoterId(String voterId) throws CustomRuntimeException{
		// TODO Auto-generated method stub
		String status[]=new String[2];
		//First check the format of voter-id
		if(AppUtil.checkVoterIdFormat(voterId)) {
			//Next check it in the database whether it exists or not
			if(votersEnrolledRepository.findByVoterId(voterId)) {
				status[0]="1";
				status[1]="Voter-Id has been verified.";
			}else {
				status[0]="0";
				status[1]="Wrong Voter-Id supplied.";
			}
		}else {
			status[0]="0";
			status[1]="Wrong Voter-Id format is supplied.";
		}
		return status;
	}

	@Override
	public String [] verifyAadharId(String aadharId) throws CustomRuntimeException{
		// TODO Auto-generated method stub
		String status[]=new String[2];
		//First check the format of aadhar-id
				if(AppUtil.checkAadharIdFormat(aadharId)) {
					//Next check it from Aadhar UID portal
					if(AppUtil.checkItFromAadharPortal(aadharId)) {
						status[0]="1";
						status[1]="Aadhar-Id has been partially verified. Pass Aadhar-OTP received at your mobile for completing Aadhar-Verification.";
						//Ask user to pass OTP sent by UID
					}else {
						status[0]="0";
						status[1]="Wrong Aadhar-Id supplied.";
					}
				}else {
					status[0]="0";
					status[1]="Wrong Aadhar-Id supplied.";
				}
				return status;
	}

	@Override
	public String [] verifyAadharOTP(String aadharOtp) throws CustomRuntimeException{
		// TODO Auto-generated method stub
		String status[]=new String[2];
		//First check the format of OTP
				if(AppUtil.checkAadharOTPFormat(aadharOtp)) {
					//Next check it from Aadhar UID portal
					if(AppUtil.checkOTPFromAadharPortal(aadharOtp)) {
						status[0]="1";
						status[1]="Aadhar-OTP has been verified. You have successfully passed all Voter-Identity-Verification.";
						
					}else {
						status[0]="0";
						status[1]="Wrong Aadhar-OTP supplied.";
					}
				}else {
					status[0]="0";
					status[1]="Wrong Aadhar-OTP supplied.";
				}
				return status;
	}

	@Override
	public String[] thumbImpressionVerification(String impression) throws CustomRuntimeException {
		// TODO Auto-generated method stub
				String status[]=new String[3];
				
							//Next check it from Aadhar UID portal
							if(AppUtil.checkImpressionFromAadharPortal(impression)) {
								status[0]="1";
								status[1]="Thum impression has been verified. Pass Aadhar OTP.";
								status[2]="999-999-999-999";
								
							}else {
								status[0]="0";
								status[1]="Wrong thumb impression supplied.";
							}
						
						return status;
	}

}
